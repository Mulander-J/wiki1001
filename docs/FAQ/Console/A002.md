# A002_VuePressåšå®¢æ­å»ºç¬”è®°ï¼ˆäºŒï¼‰ä¸ªæ€§åŒ–é…ç½® #

## &00.ä¸Šæ–‡å›é¡¾ ##

åœ¨ä¸Šæ–‡ [A001_VuePressåšå®¢æ­å»ºç¬”è®°ï¼ˆä¸€ï¼‰ç®€å•ä¸Šæ‰‹](https://mulander-j.github.io/Wiki1001Pro/FAQ/Console/A001.html) 
ä¸­ï¼Œæˆ‘ç®€å•é˜è¿°äº†**VuePress**åšå®¢æ­å»ºçš„è¿‡ç¨‹ï¼Œå¹¶å¯¹å…¶ä¸­çš„ä¸€äº›é—®é¢˜è¿›è¡Œåˆ†æè®°å½•ï¼Œ
åŒ…æ‹¬**é¦–é¡µ**ï¼Œ**ä¾§è¾¹æ **ï¼Œ**å¯¼èˆªæ **ï¼Œ**æµè§ˆå™¨ä¹¦ç­¾å¼•å…¥**ï¼Œ**æŒ‚è½½githubPage**ç­‰ç­‰ã€‚

æœ¬æ–‡å°†å›´ç»•ç€åšå®¢çš„**ä¸ªæ€§åŒ–é…ç½®**ä½œä¸€ä¸ªæ•´ç†ã€‚

é¦–å…ˆå¼•ç”¨å®˜ç½‘çš„åŸæ–‡é‡ç”³ä¸€æ¬¡**VuePress**åšå®¢æ­å»ºçš„è¿‡ç¨‹ï¼š

::: tip Start
 **As Easy as 1, 2, 3**
:::

```bash
# install
yarn global add vuepress@next 
# OR npm install -g vuepress@next

# create a markdown file
echo '# Hello VuePress' > README.md

# start writing
vuepress dev

# build to static files
vuepress build

```

## &01.ç‰ˆæœ¬æ¨è ##

**VuePress**çš„å®˜ç½‘ç›®å‰æ˜¯å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬çš„ï¼Œåˆ†åˆ«ä¸º0.xç‰ˆæœ¬å’Œæœ€æ–°çš„1.xçš„alphaç‰ˆæœ¬ã€‚
åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ç»å¸¸å› ä¸ºæ··æ·†ç‰ˆæœ¬è€Œå¯¼è‡´ä¸€äº›æ’ä»¶ä¸èƒ½æ­£å¸¸å¼•å…¥ï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯å› ä¸ºæˆ‘å¯¹**VuePress**çš„ä½¿ç”¨è¿˜ä¸ç†Ÿç»ƒã€‚
æ‰“å¼€**VuePress**çš„å®˜ç½‘ï¼Œå¦‚æœæœ‰ä¸‹é¢ç»¿è‰²çš„Noticeå¼¹å‡ºï¼Œè¯´æ˜æ˜¯1.xç‰ˆæœ¬ã€‚

![versions](./img/A002/versions.jpg)

- 0.x çš„æ–‡æ¡£: [v0.vuepress.vuejs.org](https://v0.vuepress.vuejs.org/)

- 1.x çš„æ–‡æ¡£: [v1.alpha.vuepress.vuejs.org](https://vuepress.vuejs.org/zh/)

å¦‚æœæ˜¯å¼€å‘è€…ï¼Œå»ºè®®å®‰è£…æœ€æ–°ç‰ˆ**VuePress**ï¼Œä½“éªŒæœ€æ–°çš„è½®å­~

```bash
yarn add vuepress -D       # Install 0.x.x.
yarn add vuepress@next -D  # Install next.
```

## &03.Githubé“¾æ¥  ##

ä¸githubå…³è”çš„é¡µè„šé“¾æ¥å’Œå¯¼èˆªæ é“¾æ¥ï¼Œ

```js{2}
/**
* config.js
* @type {{themeConfig: {lastUpdated: string, repoLabel: string, 
* docsDir: string, repo: string, editLinkText: string, 
* docsRepo: string, editLinks: boolean, docsBranch: string}}}
*/
module.exports = {
    // ...
    themeConfig: {
        // å‡å®šæ˜¯ GitHub. åŒæ—¶ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„ GitLab URL
        repo: 'https://github.com/Mulander-J/Wiki1001Pro.git',
        // è‡ªå®šä¹‰ä»“åº“é“¾æ¥æ–‡å­—ã€‚é»˜è®¤ä» `themeConfig.repo` ä¸­è‡ªåŠ¨æ¨æ–­ä¸º
        // "GitHub"/"GitLab"/"Bitbucket" å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ–æ˜¯ "Source"ã€‚
        repoLabel: 'GitHub',
        // ä»¥ä¸‹ä¸ºå¯é€‰çš„ç¼–è¾‘é“¾æ¥é€‰é¡¹
        // å‡å¦‚ä½ çš„æ–‡æ¡£ä»“åº“å’Œé¡¹ç›®æœ¬èº«ä¸åœ¨ä¸€ä¸ªä»“åº“ï¼š
        docsRepo: 'https://github.com/Mulander-J/Wiki1001Dev',
        // å‡å¦‚æ–‡æ¡£ä¸æ˜¯æ”¾åœ¨ä»“åº“çš„æ ¹ç›®å½•ä¸‹ï¼š
        docsDir: 'docs',
        // å‡å¦‚æ–‡æ¡£æ”¾åœ¨ä¸€ä¸ªç‰¹å®šçš„åˆ†æ”¯ä¸‹ï¼š
        docsBranch: 'master',
        // é»˜è®¤æ˜¯ false, è®¾ç½®ä¸º true æ¥å¯ç”¨
        editLinks: true,
        // é»˜è®¤ä¸º "Edit this page"
        editLinkText: 'åšä¸»é€šé“__GitHub Private Repo ï¼',
        // æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼šæ¯ä¸ªæ–‡ä»¶gitæœ€åæäº¤çš„æ—¶é—´,
        lastUpdated: 'Last Updated' ,
    }
}
```
![githubLink](./img/A002/githubLink.jpg)

## &04.ä¸ªæ€§åŒ–ä¸»é¢˜ ##

### ä¸»é¢˜ä¿®æ”¹ ###

- ä¸‹è½½é»˜è®¤ä¸»é¢˜
```bash
npm install @vuepress/theme-default@next
```
- æ›¿æ¢
```bash
##å¤åˆ¶node_modules/@vuepress/theme-default æ–‡ä»¶å¤¹
##ç²˜è´´è‡³.vuepress/ ä¸‹å¹¶æ›´åä¸ºtheme

Dev
â”œâ”€â”€â”€ docs
â”‚   â””â”€â”€ .vuepress   // é…ç½®ç›®å½•
â”‚   â”‚    â”œâ”€â”€ public // é™æ€èµ„æº
â”‚   â”‚    â”œâ”€â”€ theme // ä¸»é¢˜
â”‚   â”‚    â”‚   â”œâ”€â”€ components // ç»„ä»¶
â”‚   â”‚    â”‚   â”œâ”€â”€ global-components // å…¨å±€ç»„ä»¶
â”‚   â”‚    â”‚   â”œâ”€â”€ global-components // å…¨å±€ç»„ä»¶
â”‚   â”‚    â”‚   â”œâ”€â”€ layouts // å¸ƒå±€(åŒ…æ‹¬é¦–é¡µåœ¨å†…)
â”‚   â”‚    â”‚   â”œâ”€â”€ styles // æ ·å¼
â”‚   â”‚    â”‚   â”œâ”€â”€ util // å·¥å…·
â”‚   â”‚    â”‚   â”œâ”€â”€ index.js // å…¥å£é…ç½®
â”‚   â”‚    â”‚   â”œâ”€â”€ noopModule.js // ä¾èµ–æ³¨å…¥
â”‚   â”‚    â”‚   â”œâ”€â”€ package.json // ä¸»é¢˜ä¾èµ–
â”‚   â”‚    â”‚   â”œâ”€â”€ README.md // ä¸»é¢˜è¯´æ˜
â”‚   â”‚    â””â”€â”€ config.js
â”‚   â”œâ”€â”€ FAQ     // æ±‚ç´¢æ¨¡å—
â”‚   â”œâ”€â”€ Store   // ä»“åº“æ¨¡å—
â”‚   â”œâ”€â”€ Thought // éšç¬”æ¨¡å—
â”‚   â””â”€â”€ README.md   // åšå®¢é¦–é¡µ
â””â”€â”€ package.json
```
- è¿è¡Œ
```bash
npm run dev
```
å…³æ³¨æ§åˆ¶å°è¾“å‡º

 ``tip Apply theme located at G:\WorkSpace\WebStormWS\Wiki1001\Dev\docs\.vuepress\theme...``
 
 è‹¥æœæ§åˆ¶å°èƒ½çœ‹åˆ°ä¸Šé¢è¿™å¥è¯æˆ–è€…é¡µé¢èƒ½æ­£å¸¸æ¸²æŸ“çš„è¯ï¼Œå°±è¡¨ç¤ºä¸»é¢˜å¼•å…¥æˆåŠŸ
 
```bash
"C:\Program Files\nodejs\node.exe" "C:\Program Files\nodejs\node_modules\npm\bin\npm-cli.js" run dev --scripts-prepend-node-path=auto

> wiki1001@1.0.0 dev G:\WorkSpace\WebStormWS\Wiki1001\Dev
> vuepress dev docs

wait Extracting site metadata...
tip Apply theme located at G:\WorkSpace\WebStormWS\Wiki1001\Dev\docs\.vuepress\theme...
```
æ¥ä¸‹æ¥å°±å¯ä»¥å¯¹è¿™ä»½themeé¡¹ç›®ä½œä¿®æ”¹äº†ï¼Œ

å®ƒå°±æ˜¯è½½è´Ÿä½ çš„åšå®¢çš„ä¸€ä¸ªç®€å•çš„VUeå•é¡µé¢é¡¹ç›®ã€‚

### æ»šåŠ¨æ¡æ ·å¼ ### 

è®¾ç½®é¡µé¢æ»šåŠ¨æ¡ä¸ºæ¸å˜è‰²&åœ†è§’æ ·å¼

> å‚è€ƒ
>- [CSSè¿›é˜¶ç¯‡--è®¾ç½®æ»šåŠ¨æ¡æ ·å¼](https://segmentfault.com/a/1190000003708894)

![linear_scroll](./img/A002/linear_scroll.jpg)

```css{0}
/*å®šä¹‰æ»šåŠ¨æ¡é«˜å®½åŠèƒŒæ™¯ é«˜å®½åˆ†åˆ«å¯¹åº”æ¨ªç«–æ»šåŠ¨æ¡çš„å°ºå¯¸*/
::-webkit-scrollbar
{
  width: 8px;
  height: 8px;
  border-radius: 10px;
  background-color: #F5F5F5;
}

/*å®šä¹‰æ»šåŠ¨æ¡è½¨é“ å†…é˜´å½±+åœ†è§’*/
::-webkit-scrollbar-track
{
  border-radius: 10px;
  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
  background-color: #F5F5F5;
}

/*å®šä¹‰æ»‘å— å†…é˜´å½±+åœ†è§’*/
::-webkit-scrollbar-thumb
{
  border-radius: 10px;
  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
  border-radius: 10px;
  /* çº¿æ€§æ¸å˜ */
  background-image: -webkit-gradient(linear, 
  left bottom, left top,
   color-stop(0.44, rgb(60,186,146)), 
   color-stop(0.72, rgb(253,187,45)), 
   color-stop(0.86, rgb(253,187,45)));
  transition: 0.3s ease-in-out;
}
/*å®šä¹‰æ»‘å—æ‚¬æµ®æ ·å¼*/
::-webkit-scrollbar-thumb:hover{
  background-image: -webkit-gradient(linear, 
  left bottom, left top, 
  color-stop(0.44, rgb(253,187,45)), 
  olor-stop(0.72, rgb(253,187,45)), 
  color-stop(0.86, rgb(60,186,146)));
  transition: 0.3s ease-in-out;
}

```

### æ¸å˜è‰²æ ‡é¢˜ ###

![linear_home](./img/A002/linear_home.jpg)

```css{0}
h1{
  background-image: -webkit-linear-gradient(left,
   #22c1c3, #fdbb2d 25%, #22c1c3 50%, #fdbb2d 75%, #22c1c3);
  -webkit-text-fill-color: transparent;
  -webkit-background-clip: text;
  -webkit-background-size: 200% 100%;
  -webkit-animation: myGradientChange 4s infinite linear;
  animation: myGradientChange 4s infinite linear;
}
.description,.card h2{
  background-image: -webkit-linear-gradient(left,
   #fdbb2d, #22c1c3 25%, #fdbb2d 50%, #22c1c3 75%, #fdbb2d);
  -webkit-text-fill-color: transparent;
  -webkit-background-clip: text;
  -webkit-background-size: 200% 100%;
  -webkit-animation: myGradientChange 4s infinite linear;
  animation: myGradientChange 4s infinite linear;
}
@keyframes myGradientChange  {
  0%{ background-position: 0 0;}
  100% { background-position: -100% 0;}
}
```
### GoToEnd ###

![goTopEnd](./img/A002/goTopEnd.jpg)

- ä¸‹è½½å®˜æ–¹ç»„ä»¶BackToTop
```bash
npm install @vuepress/plugin-back-top@next
```
- æœ¬åœ°åŒ–BackToTopç»„ä»¶è‡³Layout.vueä¸­ï¼ŒåŒ…æ‹¬é¦–é¡µåœ¨å†…éƒ½ä¼šç”Ÿäº§è¯¥ç»„ä»¶
```vue{0}
//  å¤åˆ¶node_modules/@vuepress/plugin-back-top/BackToTop.vue
//  ç²˜è´´è‡³.vuepress/theme/components
<template>
  <div>
    <BackToTop></BackToTop>
  </div>
</template>

<script>
import BackToTop from '../components/BackToTop.vue'
export default {
  components: { BackToTop},
}
</script>

```
- ä¿®æ”¹Back To Top ç»„ä»¶

å¤åˆ¶ä¸€ä¸ªBack To Top DOMèŠ‚ç‚¹åŒæ—¶ä¿®æ”¹ **transition** ä¸º **transition-group**
```vue{0}
<template>
  <transition-group name="fade">
    <svg
      v-if="topShow"
      class="go-to-top"
      key="goTop"
      @click="scrollToTop"
      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49.484 28.284"
    >
      <g transform="translate(-229 -126.358)">
        <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(229 151.107) rotate(-45)"/>
        <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(274.949 154.642) rotate(-135)"/>
      </g>
    </svg>
    <svg
            v-if="endShow"
            class="go-to-top go-to-end"
            @click="scrollToEnd"
            key="goEnd"
            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49.484 28.284"
    >
      <g transform="translate(-229 -126.358)">
        <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(229 151.107) rotate(-45)"/>
        <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(274.949 154.642) rotate(-135)"/>
      </g>
    </svg>
  </transition-group>
</template>
```
å¢åŠ  å˜é‡ **scrollEnd** , **endShow** 

æ–¹æ³• **getScrollEnd()** ,**scrollToEnd()**

```vue{0}
<script>
import debounce from 'lodash.debounce'
export default {
  props: {
    threshold: {
      type: Number,
      default: 300
    }
  },
  data () {
    return {
      scrollTop: null,
      scrollEnd: null
    }
  },
  mounted () {
    this.scrollTop = this.getScrollTop()
    this.scrollEnd = this.getScrollEnd()
    window.addEventListener('scroll', debounce(() => {
      this.scrollTop = this.getScrollTop()
      this.scrollEnd = this.getScrollEnd()
    }, 100))
  },
  methods: {
    getScrollTop () {
      return window.pageYOffset ||
        document.documentElement.scrollTop ||
        document.body.scrollTop || 0
    },

    getScrollEnd () {
      return document.documentElement.scrollHeight ||
              document.body.scrollHeight || this.threshold
    },
    scrollToTop () {
      window.scrollTo({ top: 0, behavior: 'smooth' })
      this.scrollTop = 0
    },

    scrollToEnd () {
      window.scrollTo({ top: this.scrollEnd, behavior: 'smooth' })
      this.scrollTop = this.scrollEnd
    }
  },
  computed: {
    topShow () {
      return this.scrollTop > this.threshold
    },
    endShow () {
      return (this.scrollEnd - this.scrollTop) > 3*this.threshold
    }
  }
}
</script>
```
å¢åŠ ç½®åº•æŒ‰é’®æ ·å¼ï¼Œzè½´æ—‹è½¬180åº¦
```vue{0}
<style lang='stylus' scoped>
.go-to-top {
  cursor: pointer;
  position: fixed;
  bottom: 5rem;
  right: 2.5rem;
  width: 2rem;
  color: $accentColor;
  z-index: 1;
}
.go-to-end{
  bottom: 2rem;
  transform: rotateZ(180deg);
}
.go-to-top:hover {
  color: lighten($accentColor, 30%);
}

@media (max-width: 959px) {
  .go-to-top {
    display: none;
  }
}
.fade-enter-active, .fade-leave-active {
  transition: opacity 0.3s;
}
.fade-enter, .fade-leave-to {
  opacity: 0;
}
</style>
```
## &05.æ’ä»¶-PWA ##
```bash
yarn add -D @vuepress/plugin-pwa
# OR npm install -D @vuepress/plugin-pwa
```
```js{0}
//config,js
module.exports = {
// ...
 plugins: [
    ['@vuepress/pwa', {
        serviceWorker: true,
        //æŒ‡å‘è‡ªå®šä¹‰ç»„ä»¶
        popupComponent: 'MySWUpdatePopup',
        updatePopup: {
            message: "æ–°çš„é£æš´å·²ç»å‡ºç°",
            buttonText: "ç›˜ä»–"
        }
    }]
 ]
}
```
serviceWorkerçš„ä½œç”¨å¤§è‡´å°±é¡µé¢é¦–æ¬¡åŠ è½½æ—¶ä¼šè¯·æ±‚æœ¬åœ°çš„serviceWorker.jså»æ¯”å¯¹å„ä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å·
å¦‚æœä¸ä¸€è‡´åˆ™æç¤ºç”¨æˆ·æ‹‰å–æ›´æ–°
![pwa-post](./img/A002/pwa-post.jpg)
ä¸è¿‡è¿™ä¸ªpopupçš„é»˜è®¤æ ·å¼å¾ˆä¸‘ğŸ˜¨ï¼Œæ‰€ä»¥å®˜æ–¹ä¹Ÿæä¾›äº†è‡ªå®šä¹‰popupçš„æ¥å£å’Œæ•™ç¨‹
:::danger é»˜è®¤æ ·å¼
è¿™æ˜¯åŸå§‹çš„...eh
:::
![swpopup_old](./img/A002/swpopup_old.jpg)
:::warning å®˜ç½‘Demo
è¿™æ˜¯å®˜ç½‘ç»™çš„æ¨¡æ¿ = = é˜¿å’§ï¼Ÿ
:::
![swpopup_demo](./img/A002/swpopup_demo.jpg)
::: tip æˆ‘çš„Demo
è¿™æ˜¯æˆ‘çš„...emmm..å¯è¿˜è¡Œå‘¢ï¼Œå‡‘åˆç”¨äº†ã€‚è¿™ä¸ªvueçš„logoè¿˜ä¼šåŠ¨çš„ï¼Œä¸ç®—ä¾µæƒå§ğŸ˜±...@Vue??
    
P.S.è¿™ä¸ªpopup çš„å†…å®¹æ˜¯æˆ‘è‡ªå®šä¹‰å†™çš„ï¼Œä¸æ˜¯å®˜æ–¹åœ¨çš®å•Š
>å‚è€ƒ 
>- [å‰ç«¯æ¯æ—¥å®æˆ˜ï¼š4# è§†é¢‘æ¼”ç¤ºå¦‚ä½•ç”¨çº¯ CSS åˆ›ä½œä¸€ä¸ªé‡‘å±å…‰æ³½ 3D æŒ‰é’®ç‰¹æ•ˆ](https://segmentfault.com/a/1190000014599280)
>- [å‰ç«¯æ¯æ—¥å®æˆ˜ï¼š43# è§†é¢‘æ¼”ç¤ºå¦‚ä½•ç”¨çº¯ CSS ç»˜åˆ¶ä¸€ä¸ªå……æ»¡åŠ¨æ„Ÿçš„ Vue logo](https://segmentfault.com/a/1190000015177284)
:::
![sw_popup_my](./img/A002/sw_popup_my.png)
:::danger æ³¨æ„
``v-if="enabled"`` // æ·»åŠ è¿™ä¸€æ®µæŒ‡ä»¤ï¼Œå¦åˆ™popupæ— æ³•æ¶ˆå¤±
```vue{2}
<SWUpdatePopup>
    <div   v-if="enabled" 
            slot-scope="{ enabled, reload, message, buttonText }"
            class="my-sw-update-popup">
        {{ message }}<br>
        <button @click="reload">{{ buttonText }}</button>
    </div>
</SWUpdatePopup>
```
:::

## &06.æ’ä»¶-google-analytics ##

- ~~é¦–å…ˆä½ è¦æœ‰ä¸€ä¸ªè°·æ­Œè´¦å·ï¼Œ~~
- ~~ç„¶åæœ‰ä¸€ä¸ª google analyticsï¼ˆGAï¼‰è´¦æˆ·~~
- ~~ç„¶å...~~
- ~~ä¸ç”¨éº»çƒ¦äº†ä¸ç”¨éº»çƒ¦äº†~~
- ~~ä¸ç”¨éº»çƒ¦ ä¸ç”¨éº»çƒ¦äº† ä¸ç”¨éº»çƒ¦äº†~~
- ~~ä½ ä»¬ä¸€èµ·ä¸Š æˆ‘åœ¨èµ¶æ—¶é—´~~
- [å¦‚ä½•æ³¨å†Œå¹¶è®¾ç½®google analyticsï¼ˆGAï¼‰è´¦æˆ·](https://jingyan.baidu.com/article/066074d6093cf8c3c21cb0e3.html)
- **GA-ID ã‚²ãƒƒãƒˆã ã‚¼ãƒ¼ãƒ„ï¼**

![google_analysis](./img/A002/google_analysis.jpg)

- å®‰è£…å¹¶ä½¿ç”¨ **google_analysis**

```bash
yarn add -D @vuepress/plugin-google-analytics
# OR npm install -D @vuepress/plugin-google-analytics
```
```js{0}
//config.js
module.exports = {
...
  plugins: [
    ['@vuepress/google-analytics', {
        ga: '*********'//ä½ çš„Google Analytics ID
    }],
  ]
}
```
**google_analysis** ä¼šå®æ—¶ç›‘æ§ä½ çš„**url**ï¼Œå€˜è‹¥ä¸€ä¸ªé¡µé¢æœ‰å¤šä¸ªh2,h3æ ‡é¢˜ï¼Œæ»‘åŠ¨æ»šåŠ¨æ¡å¯¼è‡´**url**çš„å˜åŒ–ä¹Ÿä¼šè¢«æ•æ‰åˆ°ã€‚

![google_post](./img/A002/google_post.jpg)

## &07.è¯„è®ºç³»ç»Ÿ-Valine ##

>å‚è€ƒ 
> - [Vuepressæ­å»ºå¸¦æœ‰è¯„è®ºç³»ç»Ÿçš„åšå®¢](https://blog.csdn.net/HookJony/article/details/82027550)
> - [A fast, simple & powerful comment system. Valine](https://valine.js.org/)

- è·å–APP ID å’Œ APP Key,è¯·å…ˆç™»å½•æˆ–æ³¨å†Œ **LeanCloud**, è¿›å…¥æ§åˆ¶å°åç‚¹å‡»å·¦ä¸‹è§’åˆ›å»ºåº”ç”¨
- å®‰è£…å¹¶ä½¿ç”¨ **Valine**
```bash
# Install leancloud's js-sdk
npm install leancloud-storage --save
# Install valine
npm install valine --save
```
```js{0}
// Register AV objects to the global
window.AV = require('leancloud-storage');
// Use import
import Valine from 'valine';
// or Use require
const Valine = require('valine');
new Valine({
    el:'#vcomments',
    // other config
})
```
```vue{0}
//Page.vue
<script>
export default {
     mounted: function(){
        // require window 
        const Valine = require('valine');
        if (typeof window !== 'undefined') {
          this.window = window
          window.AV = require('leancloud-storage')
        }
        new Valine({
          el: '#vcomments' ,
          appId: '',// your appId
          appKey: '', // your appKey
          notify:false, //é‚®ç®±é€šçŸ¥ï¼Œå¯å…³é—­
          verify:false, //åäººç±»çš„ç®—æœ¯éªŒè¯ç ï¼Œå»ºè®®å…³é—­
          avatar:'mm', //å¤´åƒï¼Œé»˜è®¤å³å¯
          visitor: true,//è®¿é—®è®¡æ•°
          placeholder: 'just go go' 
        });
      }
}
</script>
```
::: warning Issue
ä¸ç®¡åœ°å€æ æ€ä¹ˆå˜åŒ–ï¼Œä¸ç®¡æ€ä¹ˆåˆ‡é¡µé¢ï¼Œè¯„è®ºå†…å®¹ä¸ä¼šéšåœ°å€æ å˜åŒ–è€Œå˜åŒ–ï¼Œå³æ— æ³•åŒæ­¥ã€‚

**Valine**å®ä¾‹ä¸**leancloud-storage**å®ä¾‹ åœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶ä¼šå‘æœåŠ¡å™¨å‘èµ·
å¸¦å½“å‰urlå‚æ•°çš„è¯·æ±‚ä»¥è·å–è¯„è®ºæ•°æ®ï¼Œè€Œè¿™ä¸ªurlå‚æ•°æ¯æ¬¡éƒ½æ˜¯ä¸€æ ·ã€‚
:::

é¦–å…ˆ**Valine** å®ä¾‹ä¸ **leancloud-storage** å®ä¾‹éƒ½åœ¨ **mounted** é’©å­ä¸­åˆå§‹åŒ–æˆ–æŒ‚è½½è‡³ **window** å¯¹è±¡ä¸Šäº†ï¼Œ

å½“é¡µé¢ **url** å˜åŒ–æ—¶ï¼Œ**Page.vue** æœ¬èº«å¹¶æ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯å®ƒèº«ä¸Šçš„`<Content/>`å†…å®¹å˜äº†ï¼Œ**mounted**æ²¡æœ‰é‡æ–°è§¦å‘ï¼Œä¸Šé¢ä¸¤ä¸ªå®ä¾‹ä¹Ÿæ²¡æœ‰æ”¹å˜ã€‚
::: danger è¡€çš„æ•™è®­
ä¸è¦åœ¨ md æ–‡ä»¶ä¸­ç›´æ¥å†™`<Content/>`,è¯·ç”¨å…¶ä»–æ ¼å¼ç¼–è¯‘å®ƒï¼Œå¦åˆ™ä¼šè¢«**vuepress**è¯†åˆ«ä¸ºç»„ä»¶è€Œä¸æ–­åŠ è½½é™·å…¥æ­»å¾ªç¯ã€‚
```js{0}
[Vue warn]: Error in nextTick: "RangeError: Maximum call stack size exceeded"
warn @ vue.runtime.esm.js?2b0e:601
vue.runtime.esm.js?2b0e:1832 RangeError: Maximum call stack size exceeded
```
```markdown{2}
åªæ˜¯å®ƒèº«ä¸Šçš„<Content/>å†…å®¹å˜äº†ï¼Œ
åªæ˜¯å®ƒèº«ä¸Šçš„`<Content/>`å†…å®¹å˜äº†ï¼Œ
```
:::
- å¦‚æœé‡æ–° init ä¸¤ä¸ªå®ä¾‹å‘¢ï¼Ÿ
    - é€šè¿‡ **watch $route** é‡æ–° **new** ä¸¤ä¸ªå®ä¾‹ä¹Ÿä¸è¡Œã€‚
    - åœ¨æ¯ä¸ªé¡µé¢çš„å†™å…¥ å¸¦ **Valine** çš„.vueç»„ä»¶ä¹Ÿä¸è¡Œã€‚
    
æš‚æ—¶æ— æ³•è§£å†³...emmm,æ¬²çŸ¥åäº‹å¦‚ä½•ï¼Œè¯·å¬ä¸‹å›åˆ†è§£..

æ¬¸ï¼Œåº”è¯¥æ²¡æœ‰ï¼ˆä¸‰ï¼‰äº†ï¼Œç­‰è§£å†³äº†ç›´æ¥å†™åœ¨è¯„è®ºé‡Œå§ã€‚    

å¤§å®¶æœ‰è§£å†³æ–¹æ³•çš„è¯ä¹Ÿæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œç•™è¨€å‰è¯· **ã€ F5 ã€‘** åˆ·æ–°ä¸‹ç¡®ä¿è¯„è®ºä¼šæäº¤åˆ°å½“å‰é¡µé¢ğŸ˜‚ğŸ˜‚ğŸ˜‚

---

## &è§£å†³Valineä¸éšé¡µé¢åˆ·æ–° ##

 Page.vue æ”¹åŠ¨å¦‚ä¸‹ï¼š

```js{0}
//  docs/.vuepress/theme/components/Page.vue
<script>
import...
export default {
   // åˆå§‹åŒ–Valineç»„ä»¶
  mounted() {
    this.renderValine()
  },
  watch :{
     // è·¯ç”±å˜åŒ–æ—¶é‡æ–°åˆå§‹åŒ–Valineç»„ä»¶
    $route (a,b) {
      if(a.path!=b.path){
        this.renderValine()
      }
    }
  },
 methods: {
    //  ç”Ÿæˆè¯„è®ºç»„ä»¶çš„ Dom å…ƒç´ 
    renderValine () {
    //  å› ä¸ºæ­¤æ–¹æ³•ä¼šæ„å»ºdomèŠ‚ç‚¹ï¼Œæ‰€ä»¥<template>ä¸­ä¸éœ€è¦å†åŠ ç›¸å…³domå…ƒç´ 
      let $page = document.querySelector('.page')
      let vcomments = document.getElementById('vcomments')
      if(!vcomments){
        vcomments = document.createElement('div')
        vcomments.id = 'vcomments'
      }
      if(this.$page.frontmatter.hideFooter){
      //    å¦‚æœforntmatterä¸­æ ‡æ³¨'hideFooterï¼štrue'åˆ™ä¸æ¸²æŸ“è¯„è®ºç»„ä»¶ï¼Œ
      //    ä½¿å¾—è¯„è®ºç»„ä»¶åœ¨å„ä¸ªé¡µé¢çš„æ˜¾ç¤ºå¯æ§
        vcomments.remove();
      }else{
        if ($page && !vcomments){
          $page.appendChild(vcomments)
        }else{
          $page = document.querySelector('.page')
          $page.appendChild(vcomments)
        }
        this.valine()
      }
    },
    //  åˆå§‹åŒ–valineå®ä¾‹
    valine () {
      const Valine = require('valine')
      const leancloudStorage = require('leancloud-storage')
      // require window
      if (typeof window !== 'undefined') {
        window.AV = leancloudStorage
      }
      //    é…ç½®valineå‚æ•°
      new Valine({
        el: '#vcomments' ,
        appId: '',// your appId
        appKey: '', // your appKey
        notify:true,
        verify:false,
        visitor: true,
        avatar:'wavatar',
        placeholder: 'æ˜¥éœ„è‹¦çŸ­ï¼Œå°‘å¥³å‰è¿›å§ï¼' +'\n'+
                'å¤œã¯çŸ­ã—æ­©ã‘ã‚ˆä¹™å¥³ï¼' +'\n'+
                'Yoru wa Mijikashi Arukeyo Otome!' +'\n'+
                'The Night is Short, Walk on Girl!',
        path: window.location.pathname
      });
    },
  }
```





